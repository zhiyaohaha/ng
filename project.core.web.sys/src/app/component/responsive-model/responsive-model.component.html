<form #form="ngForm">
  <!--添加-->
  <ng-container *ngIf="btnType === 'new';else elseblock;">
    <ng-container *ngFor="let item of modelDOMS;">
      <div class="panel clearfix" [ngStyle]="{'display': item.ui.hidden ? 'none' : 'blcok'}"
           *ngIf="item.ui.displayType === 'HtmlDomDisplayType.Panel' && !item.ui.multiple">
        <h4 class="">{{item.ui.label}}</h4>
        <ng-container *ngFor="let child of item.childrens">
          <ng-container [ngSwitch]="child.ui.displayType">
            <div class="form-group columns{{child.ui.columns}} errBorderParent" *ngSwitchCase="'HtmlDomDisplayType.Text'"
                 [ngStyle]="{'display': child.ui.hidden ? 'none' : 'show'}">   
              <timi-input [labelName]="child.ui.label" name="{{child.name}}"
                          [(ngModel)]="_modelDOMSData[child.name]"
                          [placeholder]="child.ui.placeholder" [ngClass]="{'errComponent':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}"
                          ></timi-input>
              <p [ngClass]="{'errBorder':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,"必填",child.name)}}</p>
            </div>
            <div class="form-group columns{{child.ui.columns}} " *ngSwitchCase="'HtmlDomDisplayType.Checkbox'">
              <timi-checkbox *ngIf="child.ui.multiple && child.bindData" name="{{child.name}}"
                             [(ngModel)]="_modelDOMSData[child.name]"
                             [multiple]="child.ui.multiple" [labelName]="child.ui.label"
                             [checkboxs]="child.bindData" [columns]="child.ui.columns"></timi-checkbox>
              <timi-checkbox *ngIf="!child.ui.multiple" name="{{child.name}}" [(ngModel)]="_modelDOMSData[child.name]"
                             [labelName]="child.ui.label"
                             [checkboxs]="child.ui.label" [columns]="child.ui.columns"></timi-checkbox>
            </div>
            <div class="form-group columns{{child.ui.columns}}" *ngSwitchCase="'HtmlDomDisplayType.Radio'">
              这个功能还没实现 O(∩_∩)O~
            </div>
            <input *ngSwitchCase="'HtmlDomDisplayType.Hidden'" ngModel type="hidden" name="{{child.name}}"
                   [(ngModel)]="_modelDOMSData[child.name]" placeholder="{{child.ui.placeholder}}"
                   disabled="{{child.ui.disabled}}" spellcheck="false"
                   [ngStyle]="{'display': child.ui.hidden ? 'none' : 'block'}">
            <div class="form-group columns{{child.ui.columns}} errBorderParentTextArea" *ngSwitchCase="'HtmlDomDisplayType.Textarea'"
                 [ngStyle]="{'display': child.ui.hidden ? 'none' : 'show'}">
              <timi-textarea name="{{child.name}}" [(ngModel)]="_modelDOMSData[child.name]"
                             [labelName]="child.ui.label"
                             [placeholder]="child.ui.placeholder" [ngClass]="{'errComponent':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}"></timi-textarea>
              <p [ngClass]="{'errBorder':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,"必填",child.name)}}</p>
            </div>
            <div class="form-group columns{{child.ui.columns}} errBorderParent" *ngSwitchCase="'HtmlDomDisplayType.Select'">
              <timi-select name="{{child.name}}" [(ngModel)]="_modelDOMSData[child.name]"
                           pholder="{{child.ui.placeholder || '请选择'}}" [options]="child.bindData"
                           [columns]="child.ui.columns" [multiple]="child.ui.multiple"
                           [freeSelectName]="child.ui.label || '请选择'" [filter]="child.ui.filter"
                           (onChange)="selectChange($event, child.cmds)" [ngClass]="{'errComponent':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}"></timi-select>
              <p [ngClass]="{'errBorder':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,"必选",child.name)}}</p>
            </div>
            <div class="form-group columns{{child.ui.columns}}" *ngSwitchCase="'daterange'">
              <md-input-container>
                <input mdInput [mdDatepicker]="picker" placeholder="起始时间">
                <md-datepicker-toggle mdSuffix [for]="picker"></md-datepicker-toggle>
                <md-datepicker #picker></md-datepicker>
              </md-input-container>
              &nbsp;&nbsp;--&nbsp;&nbsp;
              <md-input-container>
                <input mdInput [mdDatepicker]="picker2" placeholder="截至时间">
                <md-datepicker-toggle mdSuffix [for]="picker2"></md-datepicker-toggle>
                <md-datepicker #picker2></md-datepicker>
              </md-input-container>
            </div>
            <div class="form-group columns{{child.ui.columns}} errBorderParentFileUpLoad" *ngSwitchCase="'HtmlDomDisplayType.Upload'">
              <div>
                <timi-file-uploader name="{{child.name}}" [(ngModel)]="_modelDOMSData[child.name]"
                                    [btnName]="child.ui.label" [src]="_modelDOMSData['_'+child.name]"
                                    [columns]="child.ui.columns"
                                    (success)="uploaded($event)" (files)="selected($event)" [ngClass]="{'errComponent':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}"></timi-file-uploader>
                <p [ngClass]="{'errBorder':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,"必选",child.name)}}</p>                    
              </div>
            </div>
            <div class="form-group columns{{child.ui.columns}}  errBorderParent errBorderParentTags" *ngSwitchCase="'HtmlDomDisplayType.Tags'">
              <timi-chip-group name="{{child.name}}" [(ngModel)]="_modelDOMSData[child.name]"
                               [placeholder]="child.ui.placeholder" [labeName]="child.ui.label"
                               [columns]="child.ui.columns" [ngClass]="{'errComponent':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}"></timi-chip-group>
              <p [ngClass]="{'errBorder':vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,_modelDOMSData[child.name],child.ui.required,"必填",child.name)}}</p>                    
            </div>
            <div class="form-group columns{{child.ui.columns}}" *ngSwitchCase="'HtmlDomDisplayType.RichText'">
              <div class="box-item item-label"><label>{{child.ui.label}}</label></div>
              <div class="box-item item-control-wrapper">
                <ueditor name="{{child.name}}" [(ngModel)]="_modelDOMSData[child.name]" [loadingTip]="'加载中……'" [config]="config"></ueditor>
              </div>
            </div>
            <div class="form-group columns{{child.ui.columns}}" *ngSwitchCase="'HtmlDomDisplayType.AddressSelect'">
              <div class="box-item item-label">
                <label>{{child.ui.label}}</label>
              </div>
              <div class="box-item item-control-wrapper">
                <free-region name="{{child.name}}" [(ngModel)]="_modelDOMSData[child.name]"></free-region>
              </div>
            </div>
          </ng-container>
        </ng-container>
      </div>
      <div class="panel" [ngStyle]="{'display': item.ui.hidden ? 'none' : 'blcok'}"
           *ngIf="item.ui.displayType === 'HtmlDomDisplayType.Panel' && item.ui.multiple">
        <dynamic-doms [modelDOMS]="item" [(ngModel)]="_modelDOMSData[item.name]" name="{{item.name}}" [custom]="item.ui.attrs? item.ui.attrs[0] :''"></dynamic-doms>
      </div>
    </ng-container>
  </ng-container>
  <!--修改-->
  <ng-template #elseblock>
    <ng-container *ngFor="let item of modelDOMS;">
      <div class="panel clearfix" [ngStyle]="{'display': item.ui.hidden ? 'none' : 'blcok'}"
           *ngIf="item.ui.displayType === 'HtmlDomDisplayType.Panel' && !item.ui.multiple">
        <h4>{{item.ui.label}}</h4>
        <ng-container *ngFor="let child of item.childrens">
          <ng-container [ngSwitch]="child.ui.displayType">
            <div class="form-group columns{{child.ui.columns}} errBorderParent" *ngSwitchCase="'HtmlDomDisplayType.Text'"
                 [ngStyle]="{'display': child.ui.hidden ? 'none' : 'show'}">
                  <timi-input [labelName]="child.ui.label" name="{{child.name}}"
                  [ngModel]="child.name | ergodicJson : modelDOMSData" 
                  [(ngModel)]="modelDOMSData[child.name]" 
                  [value]="modelDOMSData[child.name]" [ngClass]="{'errComponent':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}"
                  [placeholder]="child.ui.placeholder" ></timi-input>
                  <p [ngClass]="{'errBorder':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,"必填",child.name)}}</p>
            </div>
            <div class="form-group columns{{child.ui.columns}}" *ngSwitchCase="'HtmlDomDisplayType.Checkbox'">
              <!--<timi-checkbox name="{{child.name}}" [(ngModel)]="modelDOMSData[child.name]"-->
              <!--[multiple]="child.ui.multiple" [labelName]="child.ui.label"-->
              <!--[checkboxs]="child.bindData || child.ui.label"-->
              <!--[columns]="child.ui.columns"></timi-checkbox>-->
              <timi-checkbox *ngIf="child.ui.multiple && child.bindData" name="{{child.name}}"
                             [ngModel]="child.name | ergodicJson : modelDOMSData"
                             [multiple]="child.ui.multiple" [labelName]="child.ui.label"
                             [checkboxs]="child.bindData" [columns]="child.ui.columns"></timi-checkbox>
              <timi-checkbox *ngIf="!child.ui.multiple" name="{{child.name}}" 
                             [ngModel]="child.name | ergodicJson : modelDOMSData"
                             [labelName]="child.ui.label"
                             [checkboxs]="child.ui.label" [columns]="child.ui.columns"></timi-checkbox>
            </div>
            <div class="form-group columns{{child.ui.columns}}" *ngSwitchCase="'HtmlDomDisplayType.Radio'">
              这个功能还没实现 O(∩_∩)O~
            </div>
            <input *ngSwitchCase="'HtmlDomDisplayType.Hidden'" ngModel type="hidden" name="{{child.name}}"
                   [(ngModel)]="modelDOMSData[child.name]" placeholder="{{child.ui.placeholder}}"
                   disabled="{{child.ui.disabled}}" spellcheck="false"
                   [ngStyle]="{'display': child.ui.hidden ? 'none' : 'block'}">
            <div class="form-group columns{{child.ui.columns}}  errBorderParentTextArea" *ngSwitchCase="'HtmlDomDisplayType.Textarea'"
                   [ngStyle]="{'display': child.ui.hidden ? 'none' : 'show'}">
                <timi-textarea name="{{child.name}}" 
                               [ngModel]="child.name | ergodicJson : modelDOMSData"
                               [(ngModel)]="modelDOMSData[child.name]"
                               [labelName]="child.ui.label"
                               [placeholder]="child.ui.placeholder" [columns]="child.ui.columns"
                               [ngClass]="{'errComponent':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}"
                               ></timi-textarea>
                <p [ngClass]="{'errBorder':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,"必填",child.name)}}</p>
            </div>
            <div class="form-group columns{{child.ui.columns}} errBorderParent "  *ngSwitchCase="'HtmlDomDisplayType.Select'">
              <!--<free-select name="{{child.name}}" [(ngModel)]="modelDOMSData[child.name]"-->
              <!--[selected]="modelDOMSData[child.name]"-->
              <!--pholder="{{child.ui.placeholder || '请选择'}}" [options]="child.bindData"-->
              <!--[columns]="child.ui.columns" [multiple]="child.ui.multiple"-->
              <!--[freeSelectName]="child.ui.label || '请选择'"></free-select>-->
              <timi-select name="{{child.name}}" 
                           [ngModel]="child.name | ergodicJson : modelDOMSData"
                           [(ngModel)]="modelDOMSData[child.name]"
                           pholder="{{child.ui.placeholder || '请选择'}}" [options]="child.bindData"
                           [columns]="child.ui.columns" [multiple]="child.ui.multiple"
                           [freeSelectName]="child.ui.label || '请选择'" [filter]="child.ui.filter"
                           (onChange)="selectChange($event, child.cmds)"
                           [ngClass]="{'errComponent':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}"
                           ></timi-select>
              <p [ngClass]="{'errBorder':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,"必选",child.name)}}</p>      
            </div>
            <div class="form-group columns{{child.ui.columns}}" *ngSwitchCase="'daterange'">
              <md-input-container>
                <input mdInput [mdDatepicker]="picker" placeholder="起始时间">
                <md-datepicker-toggle mdSuffix [for]="picker"></md-datepicker-toggle>
                <md-datepicker #picker></md-datepicker>
              </md-input-container>
              &nbsp;&nbsp;--&nbsp;&nbsp;
              <md-input-container>
                <input mdInput [mdDatepicker]="picker2" placeholder="截至时间">
                <md-datepicker-toggle mdSuffix [for]="picker2"></md-datepicker-toggle>
                <md-datepicker #picker2></md-datepicker>
              </md-input-container>
            </div>
            <div class="form-group columns{{child.ui.columns}}  errBorderParentFileUpLoad" *ngSwitchCase="'HtmlDomDisplayType.Upload'">
              <div>

                <timi-file-uploader name="{{child.name}}" 
                                    [ngModel]="child.name | ergodicJson : modelDOMSData"
                                    [(ngModel)]="modelDOMSData[child.name]"
                                    [btnName]="child.ui.label" [src]="displayLogoFun(child.name,modelDOMSData)" 
                                    [columns]="child.ui.columns"
                                    (success)="uploaded($event)" (files)="selected($event)"
                                    [ngClass]="{'errComponent':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}"
                                    ></timi-file-uploader>
                <p [ngClass]="{'errBorder':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,"必选",child.name)}}</p>                    
              </div>
            </div>
            <div class="form-group columns{{child.ui.columns}}  errBorderParent errBorderParentTags" *ngSwitchCase="'HtmlDomDisplayType.Tags'">
              <timi-chip-group name="{{child.name}}" 
                               [ngModel]="child.name | ergodicJson : modelDOMSData" 
                               [(ngModel)]="modelDOMSData[child.name]"
                               [placeholder]="child.ui.placeholder" [labeName]="child.ui.label"
                               [columns]="child.ui.columns"
                               [ngClass]="{'errComponent':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}"
                               ></timi-chip-group>
              <p [ngClass]="{'errBorder':vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,'必填',child.name)}">{{vertifyFun(child.verifies,modelDOMSData[child.name],child.ui.required,"必填",child.name)}}</p>                                     
            </div>
            <div class="form-group columns{{child.ui.columns}}" *ngSwitchCase="'HtmlDomDisplayType.RichText'">
              <div class="box-item item-label"><label>{{child.ui.label}}</label></div>
              <div class="box-item item-control-wrapper">
                <ueditor name="{{child.name}}" [(ngModel)]="modelDOMSData[child.name]" [loadingTip]="'加载中……'" [config]="config"></ueditor>
              </div>
            </div>
            <div class="form-group columns{{child.ui.columns}}" *ngSwitchCase="'HtmlDomDisplayType.AddressSelect'">
              hhhh
            </div>
          </ng-container>
        </ng-container>
      </div>
      <div class="panel" [ngStyle]="{'display': item.ui.hidden ? 'none' : 'blcok'}"
           *ngIf="item.ui.displayType === 'HtmlDomDisplayType.Panel' && item.ui.multiple">
        <dynamic-doms [modelDOMS]="item" [(ngModel)]="modelDOMSData[item.name]" name="{{item.name}}"  [custom]="item.ui.attrs? item.ui.attrs[0] :''"></dynamic-doms>
      </div>
    </ng-container>
  </ng-template>


  <div style="text-align: center;padding: 20px;" [ngSwitch]="btnType">
    <ng-container *ngSwitchCase="'new'">
      <button md-raised-button (click)="onSubmit(form.value)">确定</button>
    </ng-container>
    <ng-container *ngSwitchCase="'edit'">
      <button md-raised-button (click)="back()">返回</button>
      <button md-raised-button (click)="onSubmit(form.value)">确定修改</button>
    </ng-container>
    <ng-container *ngSwitchDefault>
      <button md-raised-button (click)="onSubmit(form.value)">{{btnValue}}</button>
    </ng-container>
  </div>
</form>
